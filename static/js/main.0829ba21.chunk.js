(this.webpackJsonpmovieology=this.webpackJsonpmovieology||[]).push([[0],{170:function(e,t,a){e.exports=a(280)},273:function(e,t,a){},274:function(e,t,a){},277:function(e,t,a){},279:function(e,t,a){},280:function(e,t,a){"use strict";a.r(t);a(171),a(197),a(199),a(200),a(202),a(203),a(204),a(205),a(206),a(207),a(208),a(209),a(211),a(212),a(213),a(214),a(215),a(216),a(217),a(218),a(219),a(220),a(222),a(223),a(224),a(225),a(226),a(227),a(228),a(229),a(230),a(231),a(232),a(233),a(234),a(235),a(236),a(237),a(238),a(239);var n=a(0),r=a.n(n),c=a(31),s=a.n(c),o=a(26),i=a.n(o),l=a(43),u=a(3),m=a.n(u),v=a(30),p=a(33),d=a(47),f=a(48),h=a(99),b=a.n(h),w={movies:"https://api.themoviedb.org",api:"https://movie.incodewetrust.dev",omdb:"https://www.omdbapi.com"},g=function(e,t,a){var n,r,c,s,o=arguments;return m.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=o.length>3&&void 0!==o[3]?o[3]:{},i.prev=1,r="omdb"===a?"".concat(t,"&apikey=").concat("f5f111a3"):t,i.next=5,m.a.awrap(b()({url:"".concat(w[a],"/").concat(r),method:e,data:n}));case 5:return c=i.sent,s=c.data,i.abrupt("return",s);case 10:return i.prev=10,i.t0=i.catch(1),i.abrupt("return",i.t0);case 13:case"end":return i.stop()}}),null,null,[[1,10]])},E=function(){function e(){Object(d.a)(this,e)}return Object(f.a)(e,[{key:"fetchMovies",value:function(){var e;return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.awrap(g("get","movies","api",{}));case 3:return e=t.sent,t.abrupt("return",e);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),null,null,[[0,7]])}}]),e}(),x=a(282),y=a(283);i.a.subscribe((function(){}));var k=function(){function e(){Object(d.a)(this,e)}return Object(f.a)(e,[{key:"getUserFromVk",value:function(){var e,t,a,n,r;return m.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(c.prev=0,!(e=localStorage.getItem("userId"))){c.next=8;break}return c.next=5,m.a.awrap(this.getProfile(e));case 5:return t=c.sent,this.fetchFavs(t._id),c.abrupt("return",t);case 8:return c.next=10,m.a.awrap(i.a.sendPromise("VKWebAppGetUserInfo"));case 10:return a=c.sent,c.next=13,m.a.awrap(this.getProfile(a.id));case 13:if(!(n=c.sent)){c.next=18;break}return localStorage.setItem("userId",a.id),this.fetchFavs(n._id),c.abrupt("return",n);case 18:return c.next=20,m.a.awrap(g("post","profiles","api",Object(l.a)({},Object(x.a)(["photo_max_orig","first_name","last_name"],a),{userId:a.id})));case 20:return r=c.sent,localStorage.setItem("dbId",r._id),localStorage.setItem("user",JSON.stringify(r)),this.fetchFavs(r._id),c.abrupt("return",r);case 27:throw c.prev=27,c.t0=c.catch(0),c.t0;case 30:case"end":return c.stop()}}),null,this,[[0,27]])}},{key:"like",value:function(e){var t,a;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=localStorage.getItem("dbId"),n.next=4,m.a.awrap(g("post","favorites","api",{profile:t,movie:e}));case 4:return a=n.sent,n.abrupt("return",a);case 8:throw n.prev=8,n.t0=n.catch(0),n.t0;case 11:case"end":return n.stop()}}),null,null,[[0,8]])}},{key:"unlike",value:function(e){var t,a;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=localStorage.getItem("dbId"),n.next=4,m.a.awrap(g("delete","favorites","api",{profile:t,movie:e}));case 4:return a=n.sent,n.abrupt("return",a);case 8:throw n.prev=8,n.t0=n.catch(0),n.t0;case 11:case"end":return n.stop()}}),null,null,[[0,8]])}},{key:"checkIsFav",value:function(e){var t,a;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=localStorage.getItem("dbId"),n.next=4,m.a.awrap(g("get","favorites?movie=".concat(e,"&profile=").concat(t),"api"));case 4:return a=n.sent,n.abrupt("return",!Object(y.a)(a));case 8:throw n.prev=8,n.t0=n.catch(0),n.t0;case 11:case"end":return n.stop()}}),null,null,[[0,8]])}},{key:"fetchFavs",value:function(e){var t;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,m.a.awrap(g("get","favorites?profile=".concat(e),"api"));case 3:return t=a.sent,a.abrupt("return",t);case 7:throw a.prev=7,a.t0=a.catch(0),a.t0;case 10:case"end":return a.stop()}}),null,null,[[0,7]])}},{key:"getProfile",value:function(e){var t,a,n,r;return m.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,m.a.awrap(g("get","profiles/?userId=".concat(e),"api"));case 2:if(t=c.sent,a=Object(v.a)(t,1),n=a[0],r=void 0===n?null:n,localStorage.setItem("userId",e),!r){c.next=11;break}return localStorage.setItem("dbId",r._id),localStorage.setItem("user",JSON.stringify(r)),c.abrupt("return",r);case 11:return c.abrupt("return",null);case 12:case"end":return c.stop()}}))}}]),e}(),N=new E,I=new k,O=function(){var e;return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.awrap(I.getUserFromVk());case 2:return e=t.sent,t.abrupt("return",{user:e});case 4:case"end":return t.stop()}}))},j=function(){var e;return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.awrap(N.fetchMovies());case 3:return e=t.sent,t.abrupt("return",e);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),null,null,[[0,7]])},S=function(e){var t;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,m.a.awrap(I.like(e));case 3:return t=a.sent,a.abrupt("return",t);case 7:throw a.prev=7,a.t0=a.catch(0),a.t0;case 10:case"end":return a.stop()}}),null,null,[[0,7]])},_=function(e){var t;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,m.a.awrap(I.checkIsFav(e));case 3:return t=a.sent,a.abrupt("return",t);case 7:throw a.prev=7,a.t0=a.catch(0),a.t0;case 10:case"end":return a.stop()}}),null,null,[[0,7]])},F=a(100),M=a.n(F),P=(a(273),function(e){var t=e.onFindMovie,a=e.moving,c=Object(n.useState)({processing:!1}),s=Object(v.a)(c,2),o=s[0],i=s[1];return r.a.createElement("div",{className:"movie-block"},r.a.createElement("div",{className:"movie-button"},r.a.createElement("button",{className:M()({button:!0,processing:o.processing,"element-move-top":a}),onClick:function(){i({processing:!0}),t()}},r.a.createElement("span",null,"\u0427\u0442\u043e \u0433\u043b\u044f\u043d\u0443\u0442\u044c?"),r.a.createElement("svg",{viewBox:"0 0 15 13"},r.a.createElement("polyline",{points:"2 6.5 6 10.5 13 2.5"})))))}),C=(a(274),function(e){var t=e.onFindMovie,a=e.movie;return r.a.createElement("div",{className:"welcome_panel"},r.a.createElement(P,{onFindMovie:t,movie:a}))}),V=a(101),B=a.n(V),J=a(102),A=a.n(J),R=a(103),U=a.n(R),z=(a(276),a(104)),G=a.n(z),K=(a(277),function(e){var t=e.movie,a=t.Title,n=t.Poster,c=t.Plot,s=t.Actors,o=t.Rated,i=t.Runtime,l=t.Genre,u=t.imdbRating,m=t.isFavorite,v=t._id,d=e.goBack,f=e.onLike;return r.a.createElement("div",{className:"wrap"},r.a.createElement("div",{className:"cellphone-container"},r.a.createElement("div",{className:"movie"},r.a.createElement("div",{className:"movie-img",style:{backgroundImage:"url(".concat(n,")"),backgroundSize:"cover"}}),r.a.createElement("div",{className:"text-movie-cont"},r.a.createElement("div",{className:"mr-grid"},r.a.createElement("div",{className:"col1"},r.a.createElement("h2",{className:"title"},a),r.a.createElement("ul",{className:"movie-gen"},r.a.createElement("li",null,o," /"),r.a.createElement("li",null,i," /"),r.a.createElement("li",null,l)))),r.a.createElement("div",{className:"mr-grid summary-row"},r.a.createElement("div",{className:"col2"},r.a.createElement("h3",null,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:")),r.a.createElement("div",{className:"col2"},r.a.createElement("div",{className:"movie-likes"},r.a.createElement(G.a,{width:20,height:20}),r.a.createElement("span",null,u)))),r.a.createElement("div",{className:"mr-grid"},r.a.createElement("div",{className:"col1"},r.a.createElement("p",{className:"movie-description"},c))),r.a.createElement("div",{className:"mr-grid actors-row"},r.a.createElement("div",{className:"col1"},r.a.createElement("p",{className:"movie-actors"},s.split("...")[0]))),r.a.createElement("div",{className:"mr-grid action-row"},r.a.createElement("div",{className:"col6 action-btn"},m?r.a.createElement(U.a,{width:30,height:30,style:{color:"#fe4141"},onClick:function(){return f(v)}}):r.a.createElement(A.a,{width:30,height:30,style:{color:"#fe4141"},onClick:function(){return f(v)}})),r.a.createElement("div",{className:"col6 action-btn"},r.a.createElement(B.a,{width:30,height:30,style:{color:"#fe4141"}}))),r.a.createElement("div",{className:"back-btn"},r.a.createElement(p.a,{size:"xl",level:"outline",onClick:d},"\u041d\u0430\u0437\u0430\u0434"))))))}),L=(a(278),a(279),function(){var e=Object(n.useState)("welcome"),t=Object(v.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(null),o=Object(v.a)(s,2),i=(o[0],o[1]),u=Object(n.useState)(null),d=Object(v.a)(u,2),f=d[0],h=d[1];Object(n.useEffect)((function(){!function(){var e,t;m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m.a.awrap(O());case 2:e=a.sent,t=e.user,i(t);case 5:case"end":return a.stop()}}))}()}),[]);return r.a.createElement(p.c,{activeView:a},r.a.createElement(p.d,{header:!1,activePanel:"welcome_panel",id:"welcome"},r.a.createElement(p.b,{id:"welcome_panel"},r.a.createElement(C,{onFindMovie:function(){var e,t,a,n;return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,m.a.awrap(j());case 2:return e=r.sent,t=Math.floor(Math.random()*e.length),a=e[t],r.next=7,m.a.awrap(_(a._id));case 7:n=r.sent,h(Object(l.a)({},a,{isFavorite:n})),setTimeout((function(){c("movie")}),3e3);case 10:case"end":return r.stop()}}))}}))),r.a.createElement(p.d,{header:!1,activePanel:"movie_panel",id:"movie"},r.a.createElement(p.b,{id:"movie_panel",style:{backgroundColor:"#1e1b26"}},f&&r.a.createElement(K,{movie:f,goBack:function(){return c("welcome")},onLike:function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.awrap(S(e));case 2:h(Object(l.a)({},f,{isFavorite:!0}));case 3:case"end":return t.stop()}}))}}))))});i.a.send("VKWebAppInit",{}),s.a.render(r.a.createElement(L,null),document.getElementById("root"))}},[[170,1,2]]]);
//# sourceMappingURL=main.0829ba21.chunk.js.map
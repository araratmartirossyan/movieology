(this.webpackJsonpmovieology=this.webpackJsonpmovieology||[]).push([[0],{172:function(e,t,a){e.exports=a(281)},275:function(e,t,a){},276:function(e,t,a){},278:function(e,t,a){},280:function(e,t,a){},281:function(e,t,a){"use strict";a.r(t);a(173),a(199),a(201),a(202),a(204),a(205),a(206),a(207),a(208),a(209),a(210),a(211),a(213),a(214),a(215),a(216),a(217),a(218),a(219),a(220),a(221),a(222),a(224),a(225),a(226),a(227),a(228),a(229),a(230),a(231),a(232),a(233),a(234),a(235),a(236),a(237),a(238),a(239),a(240),a(241);var n=a(28),r=a(0),c=a.n(r),s=a(34),o=a.n(s),i=a(17),u=a.n(i),l=a(33),v=a(3),p=a.n(v),m=a(35),f=a(39),d=a(40),h=a(100),w=a.n(h),b={movies:"https://api.themoviedb.org",api:"https://movie.incodewetrust.dev",omdb:"https://www.omdbapi.com"},g=function(e,t,a){var n,r,c,s,o=arguments;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=o.length>3&&void 0!==o[3]?o[3]:{},i.prev=1,r="omdb"===a?"".concat(t,"&apikey=").concat("f5f111a3"):t,i.next=5,p.a.awrap(w()({url:"".concat(b[a],"/").concat(r),method:e,data:n}));case 5:return c=i.sent,s=c.data,i.abrupt("return",s);case 10:return i.prev=10,i.t0=i.catch(1),i.abrupt("return",i.t0);case 13:case"end":return i.stop()}}),null,null,[[1,10]])},x=a(284),E=a(285),k=a(283),y=function(){function e(){Object(f.a)(this,e)}return Object(d.a)(e,[{key:"fetchMovie",value:function(e){var t;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(g("get","movies/".concat(e),"api"));case 3:return t=a.sent,a.abrupt("return",t);case 7:throw a.prev=7,a.t0=a.catch(0),a.t0;case 10:case"end":return a.stop()}}),null,null,[[0,7]])}},{key:"fetchMovies",value:function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.awrap(g("get","movies","api",{}));case 3:return e=t.sent,t.abrupt("return",e);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),null,null,[[0,7]])}},{key:"like",value:function(e){var t,a;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=localStorage.getItem("dbId"),n.next=4,p.a.awrap(g("post","favorites","api",{profile:t,movie:e}));case 4:return a=n.sent,localStorage.setItem("favId",a._id),n.abrupt("return",a);case 9:throw n.prev=9,n.t0=n.catch(0),n.t0;case 12:case"end":return n.stop()}}),null,null,[[0,9]])}},{key:"unlike",value:function(){var e,t;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e=localStorage.getItem("favId"),a.next=4,p.a.awrap(g("delete","favorites/".concat(e),"api"));case 4:return t=a.sent,a.abrupt("return",t);case 8:throw a.prev=8,a.t0=a.catch(0),a.t0;case 11:case"end":return a.stop()}}),null,null,[[0,8]])}},{key:"checkIsFav",value:function(e){var t,a,n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t=localStorage.getItem("dbId"),r.next=4,p.a.awrap(g("get","favorites?movie=".concat(e,"&profile=").concat(t),"api"));case 4:return a=r.sent,n=Object(x.a)(null,"id")(Object(E.a)(a)),localStorage.setItem("favId",n),r.abrupt("return",!Object(k.a)(a));case 10:throw r.prev=10,r.t0=r.catch(0),r.t0;case 13:case"end":return r.stop()}}),null,null,[[0,10]])}},{key:"fetchFavs",value:function(e){var t;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(g("get","favorites?profile=".concat(e),"api"));case 3:return t=a.sent,a.abrupt("return",t);case 7:throw a.prev=7,a.t0=a.catch(0),a.t0;case 10:case"end":return a.stop()}}),null,null,[[0,7]])}}]),e}(),I=a(282);u.a.subscribe((function(e){return console.log(e,"STATER")}));var N=function(){function e(){Object(f.a)(this,e)}return Object(d.a)(e,[{key:"getUserFromVk",value:function(){var e,t,a,n,r;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(c.prev=0,!(e=localStorage.getItem("userId"))){c.next=7;break}return c.next=5,p.a.awrap(this.getProfile(e));case 5:return t=c.sent,c.abrupt("return",t);case 7:return c.next=9,p.a.awrap(u.a.sendPromise("VKWebAppGetUserInfo"));case 9:return a=c.sent,c.next=12,p.a.awrap(this.getProfile(a.id));case 12:if(!(n=c.sent)){c.next=16;break}return localStorage.setItem("userId",a.id),c.abrupt("return",n);case 16:return c.next=18,p.a.awrap(g("post","profiles","api",Object(l.a)({},Object(I.a)(["photo_max_orig","first_name","last_name"],a),{userId:a.id})));case 18:return r=c.sent,localStorage.setItem("dbId",r._id),localStorage.setItem("user",JSON.stringify(r)),c.abrupt("return",r);case 24:throw c.prev=24,c.t0=c.catch(0),c.t0;case 27:case"end":return c.stop()}}),null,this,[[0,24]])}},{key:"getProfile",value:function(e){var t,a,r,c;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,p.a.awrap(g("get","profiles/?userId=".concat(e),"api"));case 2:if(t=s.sent,a=Object(n.a)(t,1),r=a[0],c=void 0===r?null:r,localStorage.setItem("userId",e),!c){s.next=11;break}return localStorage.setItem("dbId",c._id),localStorage.setItem("user",JSON.stringify(c)),s.abrupt("return",c);case 11:return s.abrupt("return",null);case 12:case"end":return s.stop()}}))}},{key:"showImage",value:function(e){u.a.send("VKWebAppShowImages",{images:[e]})}}]),e}();u.a.subscribe((function(e){return console.log(e)}));var O=function(){function e(){Object(f.a)(this,e)}return Object(d.a)(e,[{key:"onMovieShare",value:function(e){console.log(e),u.a.send("VKWebAppShare",{link:"https://vk.com/app7273858#movieId=".concat(e,"&view=movie")})}}]),e}(),j=new y,S=new N,F=new O,M=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(S.getUserFromVk());case 2:return e=t.sent,t.abrupt("return",{user:e});case 4:case"end":return t.stop()}}))},_=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.awrap(j.fetchMovies());case 3:return e=t.sent,t.abrupt("return",e);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),null,null,[[0,7]])},C=function(e){var t;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(j.like(e));case 3:return t=a.sent,a.abrupt("return",t);case 7:throw a.prev=7,a.t0=a.catch(0),a.t0;case 10:case"end":return a.stop()}}),null,null,[[0,7]])},P=function(e){var t;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(j.checkIsFav(e));case 3:return t=a.sent,a.abrupt("return",t);case 7:throw a.prev=7,a.t0=a.catch(0),a.t0;case 10:case"end":return a.stop()}}),null,null,[[0,7]])},U=function(e){return S.showImage(e)},V=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.awrap(j.unlike());case 3:return e=t.sent,t.abrupt("return",e);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),null,null,[[0,7]])},A=function(e){return F.onMovieShare(e)},R=function(e){var t,a;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,p.a.awrap(j.fetchMovie(e));case 3:return t=n.sent,n.next=6,p.a.awrap(j.checkIsFav(e));case 6:return a=n.sent,n.abrupt("return",Object(l.a)({},t,{isFavorite:a}));case 10:throw n.prev=10,n.t0=n.catch(0),n.t0;case 13:case"end":return n.stop()}}),null,null,[[0,10]])},B=a(101),J=a.n(B),K=(a(275),function(e){var t=e.onFindMovie,a=e.moving,s=Object(r.useState)({processing:!1}),o=Object(n.a)(s,2),i=o[0],u=o[1];return c.a.createElement("div",{className:"movie-block"},c.a.createElement("div",{className:"movie-button"},c.a.createElement("button",{className:J()({button:!0,processing:i.processing,"element-move-top":a}),onClick:function(){u({processing:!0}),t()}},c.a.createElement("span",null,"\u0427\u0442\u043e \u0433\u043b\u044f\u043d\u0443\u0442\u044c?"),c.a.createElement("svg",{viewBox:"0 0 15 13"},c.a.createElement("polyline",{points:"2 6.5 6 10.5 13 2.5"})))))}),L=(a(276),function(e){var t=e.onFindMovie,a=e.movie;return c.a.createElement("div",{className:"welcome_panel"},c.a.createElement(K,{onFindMovie:t,movie:a}))}),T=a(102),W=a.n(T),z=a(103),G=a.n(z),q=a(104),D=a.n(q),H=a(105),Q=a.n(H),X=(a(278),function(e){var t=e.movie,a=t.Title,n=t.Poster,r=t.Plot,s=t.Actors,o=t.Rated,i=t.Runtime,u=t.Genre,l=t.imdbRating,v=t.isFavorite,p=t._id,f=e.goBack,d=e.onLike,h=e.showImage,w=e.onUnLike,b=e.onMovieShare;return c.a.createElement("div",{className:"wrap"},c.a.createElement("div",{className:"cellphone-container"},c.a.createElement("div",{className:"movie"},c.a.createElement("div",{onClick:function(){return h(n)},className:"movie-img",style:{backgroundImage:"url(".concat(n,")"),backgroundSize:"cover"}}),c.a.createElement("div",{className:"text-movie-cont"},c.a.createElement("div",{className:"mr-grid"},c.a.createElement("div",{className:"col1"},c.a.createElement("h2",{className:"title"},a),c.a.createElement("ul",{className:"movie-gen"},c.a.createElement("li",null,o," /"),c.a.createElement("li",null,i," /"),c.a.createElement("li",null,u)))),c.a.createElement("div",{className:"mr-grid summary-row"},c.a.createElement("div",{className:"col2"},c.a.createElement("h3",null,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:")),c.a.createElement("div",{className:"col2"},c.a.createElement("div",{className:"movie-likes"},c.a.createElement(Q.a,{width:20,height:20}),c.a.createElement("span",null,l)))),c.a.createElement("div",{className:"mr-grid"},c.a.createElement("div",{className:"col1"},c.a.createElement("p",{className:"movie-description"},r))),c.a.createElement("div",{className:"mr-grid actors-row"},c.a.createElement("div",{className:"col1"},c.a.createElement("p",{className:"movie-actors"},s.split("...")[0]))),c.a.createElement("div",{className:"mr-grid action-row"},c.a.createElement("div",{className:"col6 action-btn"},v?c.a.createElement(D.a,{width:30,height:30,style:{color:"#fe4141"},onClick:function(){return w()}}):c.a.createElement(G.a,{width:30,height:30,style:{color:"#fe4141"},onClick:function(){return d(p)}})),c.a.createElement("div",{className:"col6 action-btn"},c.a.createElement(W.a,{width:30,height:30,style:{color:"#fe4141"},onClick:function(){return b(p)}}))),c.a.createElement("div",{className:"back-btn"},c.a.createElement(m.a,{size:"xl",level:"outline",onClick:f},"\u041d\u0430\u0437\u0430\u0434"))))))}),Y=(a(279),a(280),function(e){var t=e.view,a=void 0===t?"welcome":t,s=e.movieId,o=void 0===s?null:s,i=Object(r.useState)(a),u=Object(n.a)(i,2),v=u[0],f=u[1],d=Object(r.useState)(null),h=Object(n.a)(d,2),w=(h[0],h[1]),b=Object(r.useState)(null),g=Object(n.a)(b,2),x=g[0],E=g[1];Object(r.useEffect)((function(){o&&k(o),function(){var e,t;p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,p.a.awrap(M());case 2:e=a.sent,t=e.user,w(t);case 5:case"end":return a.stop()}}))}()}),[]);var k=function(e){var t;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(R(e));case 3:t=a.sent,E(Object(l.a)({},t)),a.next=10;break;case 7:throw a.prev=7,a.t0=a.catch(0),a.t0;case 10:case"end":return a.stop()}}),null,null,[[0,7]])},y=function(){var e,t=arguments;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(e=t.length>0&&void 0!==t[0]?t[0]:null)){a.next=6;break}return a.next=4,p.a.awrap(C(e));case 4:a.next=8;break;case 6:return a.next=8,p.a.awrap(V());case 8:E(Object(l.a)({},x,{isFavorite:!!e}));case 9:case"end":return a.stop()}}))};return c.a.createElement(m.c,{activeView:v},c.a.createElement(m.d,{header:!1,activePanel:"welcome_panel",id:"welcome"},c.a.createElement(m.b,{id:"welcome_panel"},c.a.createElement(L,{onFindMovie:function(){var e,t,a,n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(_());case 2:return e=r.sent,t=Math.floor(Math.random()*e.length),a=e[t],r.next=7,p.a.awrap(P(a._id));case 7:n=r.sent,E(Object(l.a)({},a,{isFavorite:n})),setTimeout((function(){f("movie")}),3e3);case 10:case"end":return r.stop()}}))}}))),c.a.createElement(m.d,{header:!1,activePanel:"movie_panel",id:"movie"},c.a.createElement(m.b,{id:"movie_panel",style:{backgroundColor:"#1e1b26"}},x&&c.a.createElement(X,{movie:x,goBack:function(){return f("welcome")},showImage:U,onLike:y,onUnLike:y,onMovieShare:A}))))});u.a.send("VKWebAppInit",{});var Z=function(e){var t=window.location.hash.replace("#","");return""===t?null:t.split("&").reduce((function(e,t){var a=t.split("="),r=Object(n.a)(a,2),c=r[0],s=r[1];return e[decodeURIComponent(c)]=decodeURIComponent(s),e}),{})}();o.a.render(c.a.createElement(Y,Z),document.getElementById("root"))}},[[172,1,2]]]);
//# sourceMappingURL=main.44fc8f26.chunk.js.map